# üéÆ Snake RL - Deep Q-Learning for Snake Game

[![Python](https://img.shields.io/badge/Python-3.13-blue.svg)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.5.1-orange.svg)](https://pytorch.org/)
[![Pygame](https://img.shields.io/badge/Pygame-2.6.1-green.svg)](https://pygame.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞ Snake —Å –æ–±—É—á–µ–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–º Deep Q-Learning –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ê–≥–µ–Ω—Ç —É—á–∏—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∏–≥—Ä—ã, –∏–∑–±–µ–≥–∞—è –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π –∏ —Å–æ–±–∏—Ä–∞—è –µ–¥—É.

## üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **DQN –ê–≥–µ–Ω—Ç**: –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –Ω–∞ PyTorch –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ü–∞—É–∑–∞/–ø–ª–µ–π —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è**: –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–∞–≥—Ä–∞–¥—ã, –¥–ª–∏–Ω—ã –∑–º–µ–π–∫–∏
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: –†–∞–∑–º–µ—Ä—ã –ø–æ–ª—è, —Å–∫–æ—Ä–æ—Å—Ç—å, –Ω–∞–≥—Ä–∞–¥—ã
- **Memory Replay**: –û–ø—ã—Ç–Ω—ã–π —Ä–µ–ø–ª–µ–∏ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- **Epsilon-Greedy Policy**: –ë–∞–ª–∞–Ω—Å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
üìÇ Snake RL
‚îú‚îÄ‚îÄ üìÇ game/                     # –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ snake_game.py           # –ö–ª–∞—Å—Å –∏–≥—Ä—ã SnakeAI
‚îÇ   ‚îî‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ä–∞–∑–º–µ—Ä—ã, —Ü–≤–µ—Ç–∞)
‚îú‚îÄ‚îÄ üìÇ agent/                   # –ê–≥–µ–Ω—Ç –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ dqn_agent.py            # DQN –∞–≥–µ–Ω—Ç —Å –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é
‚îÇ   ‚îú‚îÄ‚îÄ state_builder.py        # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ memory.py               # Memory Replay Buffer
‚îÇ   ‚îî‚îÄ‚îÄ # q_learning_agent.py   # Q-Learning (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ üìÇ visualization/           # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ plotter.py              # –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ # q_heatmap.py          # –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ Q (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ main.py                     # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md                   # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone https://github.com/iwizard7/snake_rl.git
   cd snake_rl
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   ```bash
   python3 -m venv venv_snake
   source venv_snake/bin/activate  # Linux/Mac
   # venv_snake\Scripts\activate    # Windows
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   pip install -r requirements.txt
   ```

## üéØ –ó–∞–ø—É—Å–∫

```bash
source venv_snake/bin/activate
python main.py
```

## üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### GUI –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
**–û–∫–Ω–æ –∑–º–µ–π–∫–∏ (–æ—Å–Ω–æ–≤–Ω–æ–µ):**
- üü¢ **PLAY** - –≤–∫–ª—é—á–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ (–∑–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞)
- üî¥ **PAUSE** - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ (–∫—Ä–∞—Å–Ω–∞—è/—Å–µ—Ä–∞—è –∫–Ω–æ–ø–∫–∞)
- üíæ **SAVE** - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–µ–ª—å (—Å—Ç–∞–Ω–µ—Ç –∑–µ–ª–µ–Ω–æ–π –∏ –ø–æ–∫–∞–∂–µ—Ç "SAVED!" –ø—Ä–∏ —É—Å–ø–µ—Ö–µ)
- üìÅ **LOAD** - –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å (—Å—Ç–∞–Ω–µ—Ç —Å–∏–Ω–µ–π –∏ –ø–æ–∫–∞–∂–µ—Ç "LOADED!" –ø—Ä–∏ —É—Å–ø–µ—Ö–µ)
- üìä **–ú–µ—Ç—Ä–∏–∫–∏**: –∏–≥—Ä—ã, epsilon, –≤—Ä–µ–º—è, FPS, RAM

**–û–∫–Ω–æ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞):**
- üìà –ì—Ä–∞—Ñ–∏–∫ —Å—á–µ—Ç–∞ –∑–∞ –∏–≥—Ä—ã
- üìâ –ì—Ä–∞—Ñ–∏–∫ –ø–æ—Ç–µ—Ä–∏ –º–æ–¥–µ–ª–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
- **P** - –ø–∞—É–∑–∞/–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è
- **X** (–∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ) - –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã

### –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
–ö–Ω–æ–ø–∫–∏ SAVE –∏ LOAD –¥–∞—é—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: –º–µ–Ω—è—é—Ç —Ü–≤–µ—Ç –∏ —Ç–µ–∫—Å—Ç –Ω–∞ 1.5 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.

## üß† –ú–µ—Ö–∞–Ω–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è

### –°–æ—Å—Ç–æ—è–Ω–∏–µ (State)
–í–µ–∫—Ç–æ—Ä –∏–∑ 10 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
- 3 –ø—Ä–∏–∑–Ω–∞–∫–∞ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–≤–ø–µ—Ä–µ–¥/–ª–µ–≤–æ/–ø—Ä–∞–≤–æ)
- 3 –ø—Ä–∏–∑–Ω–∞–∫–∞ –µ–¥—ã (–≤–ø–µ—Ä–µ–¥/–ª–µ–≤–æ/–ø—Ä–∞–≤–æ - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- 4 –ø—Ä–∏–∑–Ω–∞–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (one-hot: –ª–µ–≤–≤–æ/–≤–≤–µ—Ä—Ö/–≤–ø—Ä–∞–≤–æ/–≤–Ω–∏–∑)

### –î–µ–π—Å—Ç–≤–∏—è (Actions)
- 0: –í–ø–µ—Ä–µ–¥
- 1: –ü–æ–≤–æ—Ä–æ—Ç –Ω–∞–ª–µ–≤–æ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- 2: –ü–æ–≤–æ—Ä–æ—Ç –Ω–∞–ø—Ä–∞–≤–æ

### –ù–∞–≥—Ä–∞–¥—ã (Rewards)
- +10: –°—ä–µ–º –µ–¥—ã
- -10: –°–º–µ—Ä—Ç—å (—Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ)
- +0.1: –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∫ –µ–¥–µ
- -0.1: –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç –µ–¥—ã

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏
```
Input (10) -> Linear(64) -> ReLU -> Linear(32) -> ReLU -> Linear(3)
```

## üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –ì–∞–º–º–∞ (Gamma) | 0.9 |
| –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ | 1000 |
| –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è | 0.001 |
| Epsilon –Ω–∞—á–∞–ª–æ | 1.0 |
| Epsilon –º–∏–Ω–∏–º—É–º | 0.05 |
| Decay Epsilon | 0.995 |
| –†–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ | 100,000 |

## üñºÔ∏è –°–∫—Ä–∏–Ω—à–æ—Ç—ã

![–ò–≥—Ä–∞ Snake —Å DQN –æ–±—É—á–µ–Ω–∏–µ–º](screenshots/gameplay.png)
![–ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è](screenshots/plots.png)

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª—è
–í `game/config.py`:
```python
GRID_SIZE = 20  # –†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ (20x20)
BLOCK_SIZE = 20 # –†–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏ (20px)
SPEED = 40      # FPS –∏–≥—Ä—ã
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≥–µ–Ω—Ç–∞
–í `agent/dqn_agent.py`:
```python
self.epsilon = 1.0          # –ù–∞—á–∞–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
self.epsilon_decay = 0.995  # Decay epsilon
self.batch_size = 1000      # –†–∞–∑–º–µ—Ä –º–∏–Ω–∏-–±–∞—Ç—á–∞
```

## üî¨ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–í `agent/state_builder.py` - –º–µ—Ç–æ–¥ `build_state(game)`

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã
–í `game/snake_game.py` - –º–µ—Ç–æ–¥ `step(action)`

### –ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å –∞–≥–µ–Ω—Ç–∞ –≤ `agent/` –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `dqn_agent.py`

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ê–≥–µ–Ω—Ç –æ–±—É—á–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ä–µ–¥–Ω–∏–π —Å—á–µ—Ç –∑–∞ –ø–∞—Ä—Ç–∏—é. –ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `best_model.pth`.

–ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ scores –ø–∞—Ä—Ç–∏–π
- –°—Ä–µ–¥–Ω–∏–π score –ø–æ –≤—Å–µ–º –ø–∞—Ä—Ç–∏—è–º
- –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é vs –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (epsilon decay)

## ü§ù –í–∫–ª–∞–¥

1. –§–æ—Ä–∫–Ω–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –°–æ–∑–¥–∞–π—Ç–µ PR

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏

- [Reinforcement Learning: An Introduction](http://incompleteideas.net/book/the-book-2nd.html) by Sutton & Barto
- [Human-level control through deep reinforcement learning](https://deepmind.com/research/publications/human-level-control-through-deep-reinforcement-learning) by Mnih et al.
- [Playing Atari with Deep Reinforcement Learning](https://arxiv.org/abs/1312.5602) by DeepMind

## ‚úâÔ∏è –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **–ê–≤—Ç–æ—Ä**: Dmitry Sibanov
- **GitHub**: [iwizard7](https://github.com/iwizard7)

---

*"–ò–≥—Ä–∞ –Ω–µ –∑–∞–∫–æ–Ω—á–∏–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞ —Ç—ã –Ω–µ –ø—Ä–æ–∏–≥—Ä–∞–µ—à—å!"*
